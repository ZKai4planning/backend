{
  "swagger": "2.0",
  "info": {
    "title": "My API",
    "description": "API documentation",
    "version": "1.0.0"
  },
  "host": "localhost:3000",
  "basePath": "/api/v1",
  "schemes": ["http"],

  "tags": [
    { "name": "Admin Users" },
    { "name": "Admin Auth" },
    { "name": "Admin Analytics" },
    { "name": "Configuration" },
    { "name": "Roles" },
    { "name": "Services" },
    { "name": "Client Auth" },
    { "name": "Client Users" },

    { "name": "Address Lookup" }
  ],
  "paths": {
    "/admin/users": {
      "post": {
        "tags": ["Admin Users"],
        "summary": "Create admin user",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["name", "email", "roleId", "region"],
              "properties": {
                "name": { "type": "string", "example": "John Doe" },
                "email": { "type": "string", "example": "admin@example.com" },
                "roleId": { "type": "string", "example": "ADMIN" },
                "region": { "type": "string", "example": "in" }
              }
            }
          }
        ],
        "responses": {
          "201": { "description": "Admin created successfully" },
          "400": { "description": "Validation / role / config error" },
          "500": { "description": "Server error" }
        }
      },
      "get": {
        "tags": ["Admin Users"],
        "summary": "Get all admin users",
        "responses": {
          "200": {
            "description": "List of admins",
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "userId": { "type": "string" },
                  "name": { "type": "string" },
                  "email": { "type": "string" },
                  "region": { "type": "string" },
                  "roleId": { "type": "string" },
                  "roleName": { "type": "string" },
                  "isActive": { "type": "boolean" }
                }
              }
            }
          },
          "500": { "description": "Server error" }
        }
      }
    },

    "/admin/auth/{userId}": {
      "get": {
        "tags": ["Admin Users"],
        "summary": "Get admin by userId",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": { "description": "Admin details" },
          "404": { "description": "Admin not found" },
          "500": { "description": "Server error" }
        }
      },
      "put": {
        "tags": ["Admin Users"],
        "summary": "Update admin by userId",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "name": { "type": "string" },
                "email": { "type": "string" },
                "roleId": { "type": "string" },
                "region": { "type": "string" },
                "isActive": { "type": "boolean" }
              }
            }
          }
        ],
        "responses": {
          "200": { "description": "Admin updated successfully" },
          "400": { "description": "Validation error" },
          "404": { "description": "Admin not found" },
          "500": { "description": "Server error" }
        }
      }
    },

    "/admin/{userId}/status": {
      "patch": {
        "tags": ["Admin Users"],
        "summary": "Activate / Inactivate admin",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": { "description": "Status toggled successfully" },
          "404": { "description": "Admin not found" },
          "500": { "description": "Server error" }
        }
      }
    },

    "/admin/auth/login": {
      "post": {
        "tags": ["Admin Auth"],
        "summary": "Admin login (password â†’ OTP)",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["email", "password"],
              "properties": {
                "email": { "type": "string", "example": "admin@example.com" },
                "password": { "type": "string", "example": "Password@123" }
              }
            }
          }
        ],
        "responses": {
          "200": { "description": "OTP sent successfully" },
          "401": { "description": "Invalid credentials" },
          "403": { "description": "Account inactive" },
          "423": { "description": "Account locked" },
          "500": { "description": "Server error" }
        }
      }
    },

    "/admin/auth/verify-otp": {
      "post": {
        "tags": ["Admin Auth"],
        "summary": "Verify OTP",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["email", "otp"],
              "properties": {
                "email": { "type": "string" },
                "otp": { "type": "string", "example": "123456" }
              }
            }
          }
        ],
        "responses": {
          "200": { "description": "OTP verified" },
          "201": { "description": "Redirect to reset password" },
          "400": { "description": "Invalid or expired OTP" },
          "404": { "description": "User not found" }
        }
      }
    },

    "/admin/auth/resend-otp": {
      "post": {
        "tags": ["Admin Auth"],
        "summary": "Resend OTP",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["email"],
              "properties": {
                "email": { "type": "string" }
              }
            }
          }
        ],
        "responses": {
          "200": { "description": "OTP resent successfully" },
          "404": { "description": "User not found" }
        }
      }
    },

    "/admin/auth/reset-password": {
      "post": {
        "tags": ["Admin Auth"],
        "summary": "Reset password",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["email", "newPassword"],
              "properties": {
                "email": { "type": "string" },
                "newPassword": { "type": "string", "example": "NewPass@123" }
              }
            }
          }
        ],
        "responses": {
          "201": { "description": "Password reset successful" },
          "400": { "description": "Password validation failed" },
          "403": { "description": "Reset not allowed" },
          "404": { "description": "User not found" }
        }
      }
    },

    "/admin/users/analytics": {
      "get": {
        "tags": ["Admin Analytics"],
        "summary": "Get admin analytics",
        "responses": {
          "200": {
            "description": "Admin analytics data",
            "schema": {
              "type": "object",
              "properties": {
                "totalEmployees": { "type": "integer" },
                "regions": {
                  "type": "object",
                  "properties": {
                    "india": { "type": "integer" },
                    "uk": { "type": "integer" }
                  }
                },
                "status": {
                  "type": "object",
                  "properties": {
                    "active": { "type": "integer" },
                    "inactive": { "type": "integer" }
                  }
                }
              }
            }
          },
          "500": { "description": "Server error" }
        }
      }
    },

    "/auth/send-otp": {
      "post": {
        "description": "",
        "tags": ["Client Auth"],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "identifier": {
                  "example": "any"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad Request"
          },
          "423": {
            "description": "Locked"
          },
          "500": {
            "description": "Internal Server Error"
          }
        }
      }
    },
    "/auth/verify-otp": {
      "post": {
        "description": "",
         "tags": ["Client Auth"],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "identifier": {
                  "example": "any"
                },
                "otp": {
                  "example": "any"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad Request"
          },
          "401": {
            "description": "Unauthorized"
          },
          "404": {
            "description": "Not Found"
          },
          "423": {
            "description": "Locked"
          },
          "500": {
            "description": "Internal Server Error"
          }
        }
      }
    },
    "/auth/resend-otp": {
      "post": {
        "description": "",
         "tags": ["Client Auth"],
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "schema": {
              "type": "object",
              "properties": {
                "identifier": {
                  "example": "any"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "OK"
          },
          "400": {
            "description": "Bad Request"
          },
          "404": {
            "description": "Not Found"
          },
          "423": {
            "description": "Locked"
          },
          "500": {
            "description": "Internal Server Error"
          }
        }
      }
    },

    "/users/{userId}/status": {
      "patch": {
        "tags": ["Client Users"],
        "summary": "Activate or deactivate a user",
        "parameters": [
          {
            "name": "userId",
            "in": "path",
            "required": true,
            "schema": {
              "type": "string"
            }
          }
        ],
        "requestBody": {
          "required": true,
          "content": {
            "application/json": {
              "schema": {
                "type": "object",
                "required": ["isActive"],
                "properties": {
                  "isActive": {
                    "type": "boolean",
                    "example": true
                  }
                }
              }
            }
          }
        },
        "responses": {
          "200": {
            "description": "User status updated successfully",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "message": {
                      "type": "string"
                    },
                    "user": {
                      "type": "object",
                      "properties": {
                        "userId": { "type": "string" },
                        "email": { "type": "string" },
                        "phoneNumber": { "type": "string" },
                        "status": { "type": "number", "example": 0 }
                      }
                    }
                  }
                }
              }
            }
          },
          "400": {
            "description": "Invalid input"
          },
          "404": {
            "description": "User not found"
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },

    "/users": {
      "get": {
        "tags": ["Client Users"],
        "summary": "Get users with pagination and active filter",
        "parameters": [
          {
            "name": "page",
            "in": "query",
            "schema": {
              "type": "integer",
              "example": 1
            }
          },
          {
            "name": "limit",
            "in": "query",
            "schema": {
              "type": "integer",
              "example": 10
            }
          },
          {
            "name": "isActive",
            "in": "query",
            "schema": {
              "type": "boolean",
              "example": true
            },
            "description": "true = active users, false = inactive users"
          }
        ],
        "responses": {
          "200": {
            "description": "Paginated users list",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "page": { "type": "integer" },
                    "limit": { "type": "integer" },
                    "total": { "type": "integer" },
                    "users": {
                      "type": "array",
                      "items": {
                        "type": "object",
                        "properties": {
                          "userId": { "type": "string" },
                          "email": { "type": "string" },
                          "phoneNumber": { "type": "string" },
                          "status": {
                            "type": "number",
                            "example": 0
                          },
                          "profile": {
                            "type": "object",
                            "nullable": true
                          },
                          "createdAt": {
                            "type": "string",
                            "format": "date-time"
                          }
                        }
                      }
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },

    "/users/analytics": {
      "get": {
        "tags": ["Client Users"],
        "summary": "Get user count analytics",
        "responses": {
          "200": {
            "description": "User count analytics",
            "content": {
              "application/json": {
                "schema": {
                  "type": "object",
                  "properties": {
                    "totalUsers": {
                      "type": "integer",
                      "example": 120
                    },
                    "activeUsers": {
                      "type": "integer",
                      "example": 90
                    },
                    "inactiveUsers": {
                      "type": "integer",
                      "example": 30
                    }
                  }
                }
              }
            }
          },
          "500": {
            "description": "Server error"
          }
        }
      }
    },
    "/services": {
      "get": {
        "tags": ["Services"],
        "summary": "Get all services (id + name)",
        "responses": {
          "200": {
            "description": "List of services (id + name)",
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "serviceId": { "type": "string" },
                  "name": { "type": "string" }
                }
              }
            }
          },
          "500": { "description": "Failed to fetch services" }
        }
      },
      "post": {
        "tags": ["Services"],
        "summary": "Create service",
        "description": "Create a new service with optional image uploads",
        "consumes": ["multipart/form-data"],
        "parameters": [
          {
            "name": "name",
            "in": "formData",
            "required": true,
            "type": "string"
          },
          {
            "name": "description",
            "in": "formData",
            "required": false,
            "type": "string"
          },
          {
            "name": "images",
            "in": "formData",
            "required": false,
            "type": "array",
            "items": { "type": "file" }
          }
        ],
        "responses": {
          "201": { "description": "Service created successfully" },
          "400": { "description": "Name is required" },
          "500": { "description": "Failed to create service" }
        }
      }
    },
    "/services/all": {
      "get": {
        "tags": ["Services"],
        "summary": "Get all services (all details)",
        "responses": {
          "200": {
            "description": "List of services with all fields",
            "schema": {
              "type": "array",
              "items": {
                "type": "object",
                "properties": {
                  "serviceId": { "type": "string" },
                  "name": { "type": "string" },
                  "description": { "type": "string" },
                  "images": { "type": "array", "items": { "type": "string" } }
                }
              }
            }
          },
          "500": { "description": "Failed to fetch services" }
        }
      }
    },
    "/services/{serviceId}": {
      "get": {
        "tags": ["Services"],
        "summary": "Get service details",
        "parameters": [
          {
            "name": "serviceId",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": { "description": "Service details" },
          "404": { "description": "Service not found" },
          "500": { "description": "Failed to fetch service" }
        }
      },
      "put": {
        "tags": ["Services"],
        "summary": "Update service",
        "description": "Update a service's name, description, and optionally add new images",
        "consumes": ["multipart/form-data"],
        "parameters": [
          {
            "name": "serviceId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "name",
            "in": "formData",
            "required": false,
            "type": "string"
          },
          {
            "name": "description",
            "in": "formData",
            "required": false,
            "type": "string"
          },
          {
            "name": "images",
            "in": "formData",
            "required": false,
            "type": "array",
            "items": { "type": "file" }
          }
        ],
        "responses": {
          "200": { "description": "Service updated successfully" },
          "404": { "description": "Service not found" },
          "500": { "description": "Failed to update service" }
        }
      }
    },
    "/services/{serviceId}/images": {
      "delete": {
        "tags": ["Services"],
        "summary": "Remove images from a service",
        "description": "Remove one or more images from a service and delete them from Cloudinary",
        "consumes": ["application/json"],
        "parameters": [
          {
            "name": "serviceId",
            "in": "path",
            "required": true,
            "type": "string",
            "description": "Service ID"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["images"],
              "properties": {
                "images": {
                  "type": "array",
                  "items": {
                    "type": "string",
                    "example": "https://res.cloudinary.com/demo/image/upload/service_types/sample.jpg"
                  },
                  "description": "Array of image URLs to remove"
                }
              }
            }
          }
        ],
        "responses": {
          "200": {
            "description": "Images removed successfully",
            "schema": {
              "type": "object",
              "properties": {
                "message": { "type": "string" },
                "images": {
                  "type": "array",
                  "items": { "type": "string" }
                }
              }
            }
          },
          "400": {
            "description": "Images array is required"
          },
          "404": {
            "description": "Service not found"
          },
          "500": {
            "description": "Failed to remove images"
          }
        }
      }
    },
    "/configuration": {
      "get": {
        "tags": ["Configuration"],
        "summary": "Get configuration",
        "responses": {
          "200": { "description": "Returns configuration" },
          "404": { "description": "No configuration found" },
          "500": { "description": "Server error" }
        }
      },
      "post": {
        "tags": ["Configuration"],
        "summary": "Create configuration",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "defaultPassword": {
                  "type": "string",
                  "example": "password123"
                },
                "logoUrl": {
                  "type": "string",
                  "example": "https://example.com/logo.png"
                }
              }
            }
          }
        ],
        "responses": {
          "201": { "description": "Configuration created successfully" },
          "400": { "description": "Configuration already exists" },
          "500": { "description": "Server error" }
        }
      },
      "put": {
        "tags": ["Configuration"],
        "summary": "Update configuration",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "defaultPassword": {
                  "type": "string",
                  "example": "password123"
                },
                "logoUrl": {
                  "type": "string",
                  "example": "https://example.com/logo.png"
                }
              }
            }
          }
        ],
        "responses": {
          "200": { "description": "Configuration updated successfully" },
          "404": { "description": "No configuration found" },
          "500": { "description": "Server error" }
        }
      }
    },

    "/roles": {
      "get": {
        "tags": ["Roles"],
        "summary": "Get all roles",
        "responses": {
          "200": { "description": "Returns list of roles" },
          "500": { "description": "Server error" }
        }
      },
      "post": {
        "tags": ["Roles"],
        "summary": "Create role",
        "parameters": [
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "required": ["roleName"],
              "properties": {
                "roleName": {
                  "type": "string",
                  "example": "ADMIN"
                }
              }
            }
          }
        ],
        "responses": {
          "201": { "description": "Role created successfully" },
          "400": { "description": "Role name required / already exists" },
          "500": { "description": "Server error" }
        }
      }
    },
    "/roles/{roleId}": {
      "put": {
        "tags": ["Roles"],
        "summary": "Update role",
        "parameters": [
          {
            "name": "roleId",
            "in": "path",
            "required": true,
            "type": "string"
          },
          {
            "name": "body",
            "in": "body",
            "required": true,
            "schema": {
              "type": "object",
              "properties": {
                "roleName": {
                  "type": "string",
                  "example": "SUPER_ADMIN"
                },
                "status": {
                  "type": "integer",
                  "enum": [0, 1],
                  "example": 1
                }
              }
            }
          }
        ],
        "responses": {
          "200": { "description": "Role updated successfully" },
          "400": { "description": "Invalid status" },
          "404": { "description": "Role not found" },
          "500": { "description": "Server error" }
        }
      }
    },

    "/address-lookup/postcode/{postcode}": {
      "get": {
        "tags": ["Address Lookup"],
        "summary": "Get addresses by postcode",
        "parameters": [
          {
            "name": "postcode",
            "in": "path",
            "required": true,
            "type": "string"
          }
        ],
        "responses": {
          "200": { "description": "List of addresses" },
          "400": { "description": "Invalid postcode" },
          "500": { "description": "Failed to fetch addresses" }
        }
      }
    },
    "/address-lookup/by-uprn/{uprn}": {
      "get": {
        "tags": ["Address Lookup"],
        "summary": "Get address details by UPRN",
        "parameters": [
          { "name": "uprn", "in": "path", "required": true, "type": "string" }
        ],
        "responses": {
          "200": { "description": "Address details" },
          "400": { "description": "Valid UPRN required" },
          "404": { "description": "Address not found" },
          "500": { "description": "Failed to fetch address details" }
        }
      }
    }
  }
}
